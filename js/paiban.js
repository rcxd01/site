
    var S="\n\n\n ";
    var str="";

    var strGB = "°ӰհڰܰʱϱбұԱձ߱ƲɲβϲвѲҲӲԲղֲײ޲³ĳųƳͳϳҳٳ۳ܳݳ´ǴʴʹϴдѴӴԴմڴܴƵ˵еӵݵ޵ߵĶƶͶ϶жҶӶԶֶٶ۶÷ķɷ̷Ϸѷ׷طܷ߷øƸǸϸѸӸԸոָٸڸƹ˹йع۹ݹ߹źҺ׺غƻѻӻԻٻ߻üƼǼʼ̼ͼмԼռּؼۼݼ߼½ýĽŽȽɽʽνϽ׽ڽǾɾԾپݾſǿοѿҿٿ¢£¤¥¦§¨«¬­®¯°±²³¸»¼½¿áèêíóôûþıĶšŢťŦŧŨũűŵŷŸŹŻŽƭƮƵƶƻƾǣǦǨǩǫǮǯǱǳǴǵǹǺǽǾǿȣȧȨȰȴȵȷɡɥɧɨɬɱɲɴɸɾʤʥʦʨʪʫʱʴʵʶʻ˧˫˭˰˳˵˶˸˿̷̸̡̢̬̯̰̱̲̳̾ͭͳͷͺͼΤΥΧΪΫάέΰαγνϮϰϳϷϸϺϽϿХЫЭЮЯвгдклпѡѢѤѧѫѯѰѱѵѶѷѹѻѼҡҢңҤҥҩүҳҵҶҽҿӣӤӥӦӧӨөӪӫӬӮӱӴӵӸӻӽԤԦԧԨԯ԰ԱԲԵԶԸԼԾԿաբդթիծձյնշոջռսְִֻֽֿ֣֤֡֯פרשת׬׮װױ׳״׶׸׹׺׻بغ٭ٯٱٲٳٶڣڦڧڨکڪګڬڭڮگڱڲڳڴڵڶڷڸڹںڻڼڽھڿۣۦ۩۪ۻۼ۽ܼݣݥݦݪݫݰݵݺޭ޴޺ߢߣߥ߱ߴ߼߽߿";

    var strBIG5 = "}@Ka\WT[CkOͽ^rU݅ؐ^NvPůw]߅H׃qpMeTlIePKKgaؔQMKNnœ}ȃԜyԌvs׋pPaULLcSn܇؉mrηQ\GtYuX_PIINzrA|̎JNbo~n[ąfZe_JđQhʎnvu\Ifc|늝{ՙBVӆG|ӗ٪xـ呔྄ꠌDgZZ~ӞIDElPym\C؜LwuUM^SShLTpSPwݗoxؓӇD`ԓ}wsM䓾V怔Rwtomؕ^ϘُMP^^T؞VҎw|܉ԎF݁L假^nh̖uQRMaZtoWAԒщĚgh߀QoSe]xVxZRMdLȝ@؛Ce|EIuO݋DEӋӛH^oAvaZ⛃r{OԹ{gD}Oz||캆p]b`vҊIŞTuR{YvuzɔqCe_UgI^AY]þo\H֔MxaMGoL@ioRdQmfxe䏑քNXQE^x܊E_PwnѝK~Vr̝hQUϞDRه{ڔr@@m׎[|EƄڝDIhxeY[vr`zɏB砑ziĘ朑ٟZvՏ|炫CR[CUg`XIs@\Ŕn]Ǌ䓧tJRB]tu̔THXHҿ|]VGn\y݆S]Փ}_߉茻jjaΛRRIu~}mzUM֙؈^TQN]VTi[iҒdR瑑}Qև\c{yX[HȔMāfB懙Qo~ērZWtIaPri_hlؚO{uHVDĚRTM◉әUwtXQ\lqܠN@̃SN[`JHpAՈcFڅ^|xEso_׌_@gJxsqܛJc_wِ}ߝxYhW٠pBdzOIBK}{ԊrgRmҕԇ۫FݔHgQplfTqzZAb\KVCmSqOpSsiHB؝cTՄ@Cdӑv`R}wϗlNFd N~y^dDFj͑ÓrWEDmBfWf`HSȔξ^ly΁uCPu_oʏǉ]F`au㊑rݠ{bMBrwte@UFIhWwlԔʒNԇ[ϐfy{Cax\gdnC̓uSwm܎x_kWԃZӖӍdfӠ鎟}GVPBӬubG{ˎ퓘I~tUzxρˇ|xԄhxg[ay[ыtΞIωAfѓbxԁn]♪qTݛ~OcZZzuASxY@@TAhsS耻yE\NjsdٝEK菗؟t\ٛ܈lpSֱKݚ䗣ב`q~ÛwUHN@ؑᘂ\ꇒ걠b^bS|犽KN[aSEiTDTATvuDٍbyѠF٘YՁƝYnۙCvu{M荁Gd݅vIQTّqtЃzRfELeZDЖCLAVӓӏӘ֎nGbXgtrECԟԑԜԖԍԏՊ՟ԂVaNOՌՎՆ՘Ք~rRGo]@IXOBJ՛փוqukֆvPSHחd׏wPiBcJ^׉ȉNP_G˞{Oɐrd\LʁɜwCjΜ|pȇPnW~LMrʉVyʚ`AI˒\YГדd^tX]xs\`҇h}^􇂇OZKʇDˇ\ΎsFVpƫEsMJhqAGNQtx}~Ts[ԑY푫QÐŐaܑC|VZbh`YbHDIR{oTܛќҞgGZ^ƞcOs]utz|q߃ޟߊՏIƌDzȋ܋ԋz|Aw~PUSKs\t~KJuqvwkCUEIW{c_piER^JUl~|DPNbdcrOV_~zwi`RQy^|k휭tqIatywqnədfEuЙ嘡Ι{_{ܐܗV_TWF]UYeb`m݂yzwݏAOTҕϕSBLOٗDWBclgyَҗJҠ]DMPUКښ蠩VFÄĒTeĜeRSZ`jݞW̟FcU⑿ߝʹXZa~RA`bQA{OSkj[^Z`XfgpCBGIDsBetKzbAfx|PC||@nH~SsZu|HQKdUO|J}DUIky\SMNOCh|jZCOsRwFSdcRz|v[PZ]OY^gl_YWpwXXOABD`a]d]MdўcO@he@RMWhDAAlϊ͘Ϡ|͐u·ϓXϔNRVae`~jDXf[ŜAUuR{ڎzOۄVEۋ]QWUbۘXkgxznZV\Ze_fblrp}wxhׇYQ|dVcT^nbqo\~aNOEHKFTl{qvmBLZXVk^dXtyx|uWNtoB";

    var keyCode = new Array(32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 58, 59, 60, 61, 62, 63, 64, 91, 92, 93, 94, 95, 96, 123, 124, 125, 126, 65306, 12298, 12299, 12296, 12297, 8216, 8217, 8220, 8221, 65288, 65289, 65339, 65341, 65371, 65373, 8212, 8230);
    var keyTrans = new Array("","","","","","","","","","","","","","","","","E","","","","","","","","","","","","F","","","","","E","","","","","","","","","","","","","","","","");

    var keyMap = new Array();
    for (i = 0; i < keyCode.length; i++)
        keyMap[keyCode[i]] = keyTrans[i];

    var hanziMap = new Array();
    for (i = 0; i < strGB.length; i++)
        hanziMap[strGB.charCodeAt(i)] = strBIG5.charAt(i);



    function h()
    {
        var ws = parseInt(document.getElementById("iH").value);
        var H = parseInt(document.getElementById("iW").value);
        var sp = document.getElementById("iS").value;
        var SS = new Array();
        var vx = document.getElementById("srcText").value;
        var t="";


        for (var x = 0; x < vx.length; x++)
        {
            var xCode = vx.charCodeAt(x);
            if(xCode == 9 || xCode == 13)
                continue;

            if (xCode == 10)
            {
                SS[SS.length] = t;
                t="";
            }
            else
            {
                if(t.length >= ws)
                {
                    SS[SS.length] = t;
                    t="";
                }

                if (xCode >= 65 && xCode <= 90)
                    t = t + String.fromCharCode(65313 + xCode - 65);
                else if (xCode >= 97 && xCode <= 122)
                    t = t + String.fromCharCode(65345 + xCode - 97);
                else if (xCode >= 48 && xCode <= 57)
                    t = t + String.fromCharCode(65296 + xCode - 48);
                else if (keyMap[xCode] != null)
                    t = t + keyMap[xCode];
                else if ( iscbig5checked == true)
                {
                    if (hanziMap[xCode] != null)
                        t = t + hanziMap[xCode];
                    else
                    t = t + vx.charAt(x);
                }
                else
                    t = t + vx.charAt(x);
            }
        }

        SS[SS.length] = t;

        var v1 = SS.length % H;
        if (v1 != 0)
        {
            for(var x = v1 ; x < H; x++)
                SS[SS.length] = "";
        }

        str="";

        var p1=0;
        var ll=SS.length;

        while(p1<ll)
        {
            var p2 = p1+H-1 < ll ? p1+H-1 : ll-1;
            for(var y=0; y < ws; y++)
            {
                for(var x = p2; x >= p1; x--)
                {
                    if(SS[x].length>y)
                    {
                        if(SS[x].charCodeAt(y)>127)
                            str = str + SS[x].charAt(y) + sp;
                        else
                            str = str + SS[x].charAt(y) + " " + sp;
                    }
                    else
                    {
                        str = str + "" + sp;
                    }
                }
                str = str + "\n";
            }
            str = str + S;
            p1=p2+1;
        }

        document.getElementById("tarText").value=str;
    }

    var iscbig5checked=false;

    function cbig5()
    {

        if (iscbig5checked)
        {
 
            iscbig5checked=false;
        }
        else
        {
 
            iscbig5checked=true;
        }
    }